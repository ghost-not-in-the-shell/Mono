module Mono.Typed.Term where
open import Mono.Untyped.PreTerm
open import Mono.Untyped.Weakening
open import Mono.Untyped.Substitution

infix 4 _ctx
infix 4 _âˆ‹_âˆ¶_
infix 4 _âŠ¢_âˆ¶_
infix 4 _âŠ¢_âˆ¼_âˆ¶_

data _âˆ‹_âˆ¶_ : âˆ€ {ğ”«} â†’ Con ğ”« â†’ Var ğ”« â†’ Tm ğ”« â†’ Set where
  ğ•«ğ•–ğ•£ğ•  : âˆ€ {ğ”«} {Î“ : Con ğ”«} {A : Tm ğ”«}
    â†’ Î“ , A âˆ‹ zero âˆ¶ A [â†‘]

  ğ•¤ğ•¦ğ•” : âˆ€ {ğ”«} {Î“ : Con ğ”«} {A B : Tm ğ”«} {x : Var ğ”«}
    â†’ Î“     âˆ‹     x âˆ¶ A
    â†’ Î“ , B âˆ‹ suc x âˆ¶ A [â†‘]

mutual
  data _ctx : âˆ€ {ğ”«} â†’ Con ğ”« â†’ Set where
    Â· : Â· ctx

    _,_ : âˆ€ {ğ”«} {Î“ : Con ğ”«} {A : Tm ğ”«}
      â†’ (ğ”¾ : Î“ ctx)
      â†’ (ğ”¸ : ğ”¾ âŠ¢ A âˆ¶ U)
      â†’      Î“ , A ctx

  data _âŠ¢_âˆ¶_ {ğ”«} {Î“ : Con ğ”«} (ğ”¾ : Î“ ctx) : Tm ğ”« â†’ Tm ğ”« â†’ Set where
    ğ•Œ : ğ”¾ âŠ¢ U âˆ¶ U

    â„¿ : âˆ€ {A B}
      â†’ (ğ”¸ : ğ”¾     âŠ¢     A âˆ¶ U)
      â†’ (ğ”¹ : ğ”¾ , ğ”¸ âŠ¢     B âˆ¶ U)
      â†’      ğ”¾     âŠ¢ Î  A B âˆ¶ U

    ğ•‹ : ğ”¾ âŠ¢ T âˆ¶ U

    ğ•§ğ•’ğ•£ : âˆ€ {A x}
      â†’ (ğ•© : Î“ âˆ‹     x âˆ¶ A)
      â†’      ğ”¾ âŠ¢ var x âˆ¶ A

    ğ•ğ•’ğ• : âˆ€ {A B t}
      â†’ {ğ”¸ : ğ”¾     âŠ¢     A âˆ¶ U}
      â†’ (ğ•¥ : ğ”¾ , ğ”¸ âŠ¢     t âˆ¶ B)
      â†’      ğ”¾     âŠ¢ lam t âˆ¶ Î  A B

    ğ•’ğ•¡ğ•¡ : âˆ€ {A B t u}
      â†’ (ğ•¥ : ğ”¾ âŠ¢       t âˆ¶ Î  A B)
      â†’ (ğ•¦ : ğ”¾ âŠ¢       u âˆ¶ A)
      â†’      ğ”¾ âŠ¢ app t u âˆ¶ B [ u ]â‚

    ğ•¥ğ•¥ : ğ”¾ âŠ¢ tt âˆ¶ T

    _â‰«_ : âˆ€ {A B t}
      â†’ (ğ•¥ : ğ”¾ âŠ¢     t âˆ¶ A)
      â†’ (â„ : ğ”¾ âŠ¢ A âˆ¼ B âˆ¶ U)
      â†’      ğ”¾ âŠ¢     t âˆ¶ B

  data _âŠ¢_âˆ¼_âˆ¶_ {ğ”«} {Î“ : Con ğ”«} (ğ”¾ : Î“ ctx) : Tm ğ”« â†’ Tm ğ”« â†’ Tm ğ”« â†’ Set where
    ğ•£ğ•–ğ•—ğ• : âˆ€ {A t}
      â†’ (ğ•¥ : ğ”¾ âŠ¢     t âˆ¶ A)
      â†’      ğ”¾ âŠ¢ t âˆ¼ t âˆ¶ A

    ğ•¤ğ•ªğ• : âˆ€ {A tâ‚ tâ‚‚}
      â†’ (ğ•¡ : ğ”¾ âŠ¢ tâ‚ âˆ¼ tâ‚‚ âˆ¶ A)
      â†’      ğ”¾ âŠ¢ tâ‚‚ âˆ¼ tâ‚ âˆ¶ A

    ğ•¥ğ•£ğ•’ğ•Ÿğ•¤ : âˆ€ {A tâ‚ tâ‚‚ tâ‚ƒ}
      â†’ (ğ•¡ : ğ”¾ âŠ¢ tâ‚ âˆ¼ tâ‚‚ âˆ¶ A)
      â†’ (ğ•¢ : ğ”¾ âŠ¢ tâ‚‚ âˆ¼ tâ‚ƒ âˆ¶ A)
      â†’      ğ”¾ âŠ¢ tâ‚ âˆ¼ tâ‚ƒ âˆ¶ A

    â„¿-ğ•”ğ• ğ•Ÿğ•˜ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚}
      â†’ {ğ”¸â‚ : ğ”¾      âŠ¢                Aâ‚ âˆ¶ U}
      â†’ (â„â‚ : ğ”¾      âŠ¢      Aâ‚ âˆ¼      Aâ‚‚ âˆ¶ U)
      â†’ (â„â‚‚ : ğ”¾ , ğ”¸â‚ âŠ¢      Bâ‚ âˆ¼      Bâ‚‚ âˆ¶ U)
      â†’       ğ”¾      âŠ¢ Î  Aâ‚ Bâ‚ âˆ¼ Î  Aâ‚‚ Bâ‚‚ âˆ¶ U

    ğ•ğ•’ğ•-ğ•”ğ• ğ•Ÿğ•˜ : âˆ€ {A B tâ‚ tâ‚‚}
      â†’ {ğ”¸ : ğ”¾     âŠ¢               A âˆ¶ U}
      â†’ (ğ•¡ : ğ”¾ , ğ”¸ âŠ¢     tâ‚ âˆ¼     tâ‚‚ âˆ¶ B)
      â†’      ğ”¾     âŠ¢ lam tâ‚ âˆ¼ lam tâ‚‚ âˆ¶ Î  A B

    ğ•’ğ•¡ğ•¡-ğ•”ğ• ğ•Ÿğ•˜ : âˆ€ {A B tâ‚ tâ‚‚ uâ‚ uâ‚‚}
      â†’ (ğ•¡ : ğ”¾ âŠ¢        tâ‚ âˆ¼        tâ‚‚ âˆ¶ Î  A B)
      â†’ (ğ•¢ : ğ”¾ âŠ¢        uâ‚ âˆ¼        uâ‚‚ âˆ¶ A)
      â†’      ğ”¾ âŠ¢ app tâ‚ uâ‚ âˆ¼ app tâ‚‚ uâ‚‚ âˆ¶ B [ tâ‚ ]â‚

    â„¿-ğ•“ğ•–ğ•¥ğ•’ : âˆ€ {A B t u}
      â†’ {ğ”¸ : ğ”¾     âŠ¢                        A âˆ¶ U}
      â†’ (ğ•¥ : ğ”¾ , ğ”¸ âŠ¢                        t âˆ¶ B)
      â†’ (ğ•¦ : ğ”¾     âŠ¢                        u âˆ¶ A)
      â†’      ğ”¾     âŠ¢ app (lam t) u âˆ¼ t [ u ]â‚ âˆ¶ B [ u ]â‚

    â„¿-ğ•–ğ•¥ğ•’ : âˆ€ {A B t}
      â†’ (ğ•¥ : ğ”¾ âŠ¢                                t âˆ¶ Î  A B)
      â†’      ğ”¾ âŠ¢ t âˆ¼ lam (app (t [â†‘]) (var zero)) âˆ¶ Î  A B

    _â‰«_ : âˆ€ {A B tâ‚ tâ‚‚}
      â†’ (ğ•¡ : ğ”¾ âŠ¢ tâ‚ âˆ¼ tâ‚‚ âˆ¶ A)
      â†’ (â„ : ğ”¾ âŠ¢ A  âˆ¼ B  âˆ¶ U)
      â†’      ğ”¾ âŠ¢ tâ‚ âˆ¼ tâ‚‚ âˆ¶ B
