module Mono.Typed.WeakeningNotWorkingSoWell where
open import Mono.Prelude
open import Mono.Untyped.PreTerm
open import Mono.Untyped.Weakening
open import Mono.Untyped.Weakening.Properties
open import Mono.Untyped.Substitution
open import Mono.Untyped.Substitution.Properties
open import Mono.Typed.Term

infix  4 _âŠ‡_âˆ¶_

mutual
  data _âŠ‡_âˆ¶_ : âˆ€ {ğ”ª ğ”«} {Î” : Con ğ”ª} {Î“ : Con ğ”«} (ğ”» : Î” ctx) (ğ“Œ : Ren ğ”ª ğ”«) (ğ”¾ : Î“ ctx) â†’ Set where
    ğ••ğ• ğ•Ÿğ•– : Â· âŠ‡ done âˆ¶ Â·

    ğ•¤ğ•œğ•šğ•¡ : âˆ€ {ğ”ª} {Î” : Con ğ”ª} {ğ”» : Î” ctx}
             {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
             {ğ“Œ : Ren ğ”ª ğ”«} {A : Tm ğ”ª} {ğ”¸ : ğ”» âŠ¢ A âˆ¶ U}
           â†’ (ğ•¨ : ğ”»      âŠ‡      ğ“Œ âˆ¶ ğ”¾)
           â†’      ğ”» , ğ”¸  âŠ‡ skip ğ“Œ âˆ¶ ğ”¾

    ğ•œğ•–ğ•–ğ•¡ : âˆ€ {ğ”ª} {Î” : Con ğ”ª} {ğ”» : Î” ctx}
             {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
             {ğ“Œ : Ren ğ”ª ğ”«} {A : Tm ğ”«} {ğ”¸ : ğ”¾ âŠ¢ A âˆ¶ U}
           â†’ (ğ•¨ : ğ”»            âŠ‡      ğ“Œ âˆ¶ ğ”¾)
           â†’      ğ”» , ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ”¸ âŠ‡ keep ğ“Œ âˆ¶ ğ”¾ , ğ”¸

  ğ•£ğ•–ğ•Ÿâˆ‹ : âˆ€ {ğ”ª} {Î” : Con ğ”ª} {ğ”» : Î” ctx}
           {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
           {ğ“Œ : Ren ğ”ª ğ”«} {A : Tm ğ”«} {x : Var ğ”«}
         â†’ ğ”» âŠ‡        ğ“Œ âˆ¶ ğ”¾
         â†’ Î“ âˆ‹        x âˆ¶ A
         â†’ Î” âˆ‹ renâˆ‹ ğ“Œ x âˆ¶ renâŠ¢ ğ“Œ A
  ğ•£ğ•–ğ•Ÿâˆ‹          ğ••ğ• ğ•Ÿğ•–    ()
  ğ•£ğ•–ğ•Ÿâˆ‹ {Î” = Î”} (ğ•¤ğ•œğ•šğ•¡ ğ•¨) ğ•©       = ğ•¤ğ•¦ğ•” (ğ•£ğ•–ğ•Ÿâˆ‹ ğ•¨ ğ•©) âŸ¦ Î” âˆ‹ _ âˆ¶_ âŸ¨$âŸ© renâŠ¢â€¿skip âŸ«
  ğ•£ğ•–ğ•Ÿâˆ‹ {Î” = Î”} (ğ•œğ•–ğ•–ğ•¡ ğ•¨) ğ•«ğ•–ğ•£ğ•     = ğ•«ğ•–ğ•£ğ•            âŸ¦ Î” âˆ‹ _ âˆ¶_ âŸ¨$âŸ© renâŠ¢â€¿keep âŸ«
  ğ•£ğ•–ğ•Ÿâˆ‹ {Î” = Î”} (ğ•œğ•–ğ•–ğ•¡ ğ•¨) (ğ•¤ğ•¦ğ•” ğ•©) = ğ•¤ğ•¦ğ•” (ğ•£ğ•–ğ•Ÿâˆ‹ ğ•¨ ğ•©) âŸ¦ Î” âˆ‹ _ âˆ¶_ âŸ¨$âŸ© renâŠ¢â€¿keep âŸ«

  ğ•£ğ•–ğ•ŸâŠ¢ : âˆ€ {ğ”ª} {Î” : Con ğ”ª} {ğ”» : Î” ctx}
           {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
           {ğ“Œ : Ren ğ”ª ğ”«} {A : Tm ğ”«} {t : Tm ğ”«}
         â†’ ğ”» âŠ‡        ğ“Œ âˆ¶ ğ”¾
         â†’ ğ”¾ âŠ¢        t âˆ¶ A
         â†’ ğ”» âŠ¢ renâŠ¢ ğ“Œ t âˆ¶ renâŠ¢ ğ“Œ A
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•Œ)               = ğ•Œ
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (â„¿ ğ”¸ ğ”¹)           = â„¿ (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ”¸) (ğ•£ğ•–ğ•ŸâŠ¢ (ğ•œğ•–ğ•–ğ•¡ ğ•¨) ğ”¹)
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•‹)               = ğ•‹
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•§ğ•’ğ•£ ğ•©)           = ğ•§ğ•’ğ•£ (ğ•£ğ•–ğ•Ÿâˆ‹ ğ•¨ ğ•©)
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•ğ•’ğ• ğ•¥)           = ğ•ğ•’ğ• (ğ•£ğ•–ğ•ŸâŠ¢ (ğ•œğ•–ğ•–ğ•¡ ğ•¨) ğ•¥)
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•’ğ•¡ğ•¡ {B = B} ğ•¥ ğ•¦) = ğ•’ğ•¡ğ•¡ (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¥) (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¦) âŸ¦ _ âŠ¢ _ âˆ¶_ âŸ¨$âŸ© sym (renâŠ¢â€¿subâ‚ B) âŸ«
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•¥ğ•¥)              = ğ•¥ğ•¥
  ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ (ğ•¥ â‰« â„)           = ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¥ â‰« ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ â„

  ğ•£ğ•–ğ•Ÿâˆ¼ : âˆ€ {ğ”ª} {Î” : Con ğ”ª} {ğ”» : Î” ctx}
           {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
           {ğ“Œ : Ren ğ”ª ğ”«} {A : Tm ğ”«} {tâ‚ tâ‚‚ : Tm ğ”«}
         â†’ ğ”» âŠ‡                     ğ“Œ âˆ¶ ğ”¾
         â†’ ğ”¾ âŠ¢        tâ‚ âˆ¼        tâ‚‚ âˆ¶ A
         â†’ ğ”» âŠ¢ renâŠ¢ ğ“Œ tâ‚ âˆ¼ renâŠ¢ ğ“Œ tâ‚‚ âˆ¶ renâŠ¢ ğ“Œ A
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•£ğ•–ğ•—ğ•  ğ•¥)                 = ğ•£ğ•–ğ•—ğ•  (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¥)
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•¤ğ•ªğ•   ğ•¡)                 = ğ•¤ğ•ªğ•   (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¡)
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•¥ğ•£ğ•’ğ•Ÿğ•¤ ğ•¡ ğ•¢)               = ğ•¥ğ•£ğ•’ğ•Ÿğ•¤ (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¡) (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¢)
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (â„¿-ğ•”ğ• ğ•Ÿğ•˜ â„â‚ â„â‚‚)            = â„¿-ğ•”ğ• ğ•Ÿğ•˜ (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ â„â‚) (ğ•£ğ•–ğ•Ÿâˆ¼ (ğ•œğ•–ğ•–ğ•¡ ğ•¨) â„â‚‚)
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•ğ•’ğ•-ğ•”ğ• ğ•Ÿğ•˜ ğ•¡)              = ğ•ğ•’ğ•-ğ•”ğ• ğ•Ÿğ•˜ (ğ•£ğ•–ğ•Ÿâˆ¼ (ğ•œğ•–ğ•–ğ•¡ ğ•¨) ğ•¡)
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•’ğ•¡ğ•¡-ğ•”ğ• ğ•Ÿğ•˜ {B = B} ğ•¡ ğ•¢)    = ğ•’ğ•¡ğ•¡-ğ•”ğ• ğ•Ÿğ•˜ (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¡) (ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¢) âŸ¦ _ âŠ¢ _ âˆ¼ _ âˆ¶_ âŸ¨$âŸ© sym (renâŠ¢â€¿subâ‚ B) âŸ«
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (â„¿-ğ•“ğ•–ğ•¥ğ•’ {B = B} {t} ğ•¥ ğ•¦)  = â„¿-ğ•“ğ•–ğ•¥ğ•’ (ğ•£ğ•–ğ•ŸâŠ¢ (ğ•œğ•–ğ•–ğ•¡ ğ•¨) ğ•¥) (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¦) âŸ¦ _ âŠ¢ app _ _ âˆ¼_âˆ¶_ âŸ¨$âŸ© sym (renâŠ¢â€¿subâ‚ t) âŸ¨*âŸ© sym (renâŠ¢â€¿subâ‚ B) âŸ«
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (â„¿-ğ•–ğ•¥ğ•’ ğ•¥)                 = â„¿-ğ•–ğ•¥ğ•’ (ğ•£ğ•–ğ•ŸâŠ¢ ğ•¨ ğ•¥) âŸ¦ (Î» u â†’ _ âŠ¢ renâŠ¢ _ _ âˆ¼ lam (app u (var zero)) âˆ¶ _) âŸ¨$âŸ© renâŠ¢â€¿keep âŸ«
  ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ (ğ•¡ â‰« â„)                   = ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ ğ•¡ â‰« ğ•£ğ•–ğ•Ÿâˆ¼ ğ•¨ â„

mutual
  ğ•šğ•• : âˆ€ {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx}
    â†’ ğ”¾ âŠ‡ id âˆ¶ ğ”¾
  ğ•šğ•• {ğ”¾ = Â·}     = ğ••ğ• ğ•Ÿğ•–
  ğ•šğ•• {ğ”¾ = ğ”¾ , ğ”¸} = ğ•œğ•–ğ•–ğ•¡ ğ•šğ•• âŸ¦ (Î» ğ”¹ â†’ ğ”¾ , ğ”¹ âŠ‡ keep id âˆ¶ ğ”¾ , ğ”¸) âŸ¨$âŸ© ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• ğ”¸ âŸ«
                           âŸ¦ (Î» ğ”¹ â†’ ğ”¾ , ğ”¹ âŸ¦ ğ”¾ âŠ¢_âˆ¶_ âŸ¨$âŸ© renâŠ¢â€¿id _ âŸ¨*âŸ© renâŠ¢â€¿id U âŸ« âŠ‡ keep id âˆ¶ ğ”¾ , ğ”¸) âŸ¨$âŸ© refl âŸ«
    -- ğ•œğ•–ğ•–ğ•¡ ğ•šğ•• âŸ¦ (Î» ğ”¹ â†’ ğ”¾ , (ğ”¹ âŸ¦ (Î» B â†’ ğ”¾ âŠ¢ B âˆ¶ U) âŸ¨$âŸ© {!!} âŸ«) âŠ‡ keep id âˆ¶ ğ”¾ , ğ”¸) âŸ¨$âŸ© {!ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• ğ”¸!} âŸ«
    -- = ğ•œğ•–ğ•–ğ•¡ ğ•šğ•• âŸ¦ (Î» ğ”¹ â†’ ğ”¾ , ğ”¹ âŠ‡ keep id âˆ¶ ğ”¾ , ğ”¸) âŸ¨$âŸ© ? âŸ«

  ğ•£ğ•–ğ•Ÿâˆ‹-ğ•šğ•• : âˆ€ {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx} {A : Tm ğ”«} {x : Var ğ”«}
    â†’ (ğ•© : Î“ âˆ‹ x âˆ¶ A)
    â†’ ğ•£ğ•–ğ•Ÿâˆ‹ ğ•šğ•• ğ•© â‰¡ ğ•© âŸ¦ Î“ âˆ‹_âˆ¶_ âŸ¨$âŸ© sym (renâˆ‹-id x) âŸ¨*âŸ© sym (renâŠ¢â€¿id A) âŸ«
--    â†’ ğ•£ğ•–ğ•Ÿâˆ‹ ğ•šğ•• ğ•© âŸ¦ Î“ âˆ‹_âˆ¶_ âŸ¨$âŸ© renâˆ‹-id x âŸ¨*âŸ© renâŠ¢â€¿id A âŸ« â‰¡ ğ•©
  ğ•£ğ•–ğ•Ÿâˆ‹-ğ•šğ•• ğ•«ğ•–ğ•£ğ•     = refl
  ğ•£ğ•–ğ•Ÿâˆ‹-ğ•šğ•• (ğ•¤ğ•¦ğ•” ğ•©) = refl

  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• : âˆ€ {ğ”«} {Î“ : Con ğ”«} {ğ”¾ : Î“ ctx} {A : Tm ğ”«} {t : Tm ğ”«}
    â†’ (ğ•¥ : ğ”¾ âŠ¢ t âˆ¶ A)
    â†’ ğ•£ğ•–ğ•ŸâŠ¢ ğ•šğ•• ğ•¥ â‰¡ ğ•¥ âŸ¦ ğ”¾ âŠ¢_âˆ¶_ âŸ¨$âŸ© sym (renâŠ¢â€¿id t) âŸ¨*âŸ© sym (renâŠ¢â€¿id A) âŸ«
--    â†’ ğ•£ğ•–ğ•ŸâŠ¢ ğ•šğ•• ğ•¥ âŸ¦ ğ”¾ âŠ¢_âˆ¶_ âŸ¨$âŸ© renâŠ¢â€¿id t âŸ¨*âŸ© renâŠ¢â€¿id A âŸ« â‰¡ ğ•¥
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• ğ•Œ = refl
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• (â„¿ ğ•¥ ğ•¥â‚) = {!!}
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• ğ•‹ = refl
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• (ğ•§ğ•’ğ•£ ğ•©) = {!ğ•§ğ•’ğ•£ âŸ¨$âŸ© ?!}
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• (ğ•ğ•’ğ• ğ•¥) = {!!}
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• (ğ•’ğ•¡ğ•¡ ğ•¥ ğ•¥â‚) = {!!}
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• ğ•¥ğ•¥ = refl
  ğ•£ğ•–ğ•ŸâŠ¢â€¿ğ•šğ•• (ğ•¥ â‰« â„) = {!!}
